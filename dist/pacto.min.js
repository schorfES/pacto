!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.pacto=e():t.pacto=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);const r=new WeakMap;class s{constructor(){r.set(this,{})}on(t,e){const n=r.get(this);return n[t]=n[t]||[],n[t].push(e),this}off(t,e){const n=r.get(this);return n[t]&&(n[t]=e?n[t].filter(t=>t!==e):[]),this}trigger(t,e=null){const n=r.get(this);return n[t]&&n[t].forEach(n=>n.call(null,{sender:this,type:t,data:e})),this}}const o=new WeakMap;class c extends s{constructor(t={}){super();const e=new Proxy(t,{set:(t,e,n)=>{let r=t[e]!==n;return t[e]=n,r&&this.trigger("change",{prop:e,value:n}),!0}});o.set(this,e)}get props(){return o.get(this)}}const i=new WeakMap;class u extends s{constructor(t=[]){super();const e=t=>t instanceof c?t:new this.Model(t),n={get:(t,n)=>{const r=t[n];return"function"==typeof r?(...s)=>{let o,c=!1;switch(n){case"pop":case"shift":case"reverse":case"sort":c=!0;break;case"fill":case"push":case"unshift":c=!0,s=s.map(e);break;case"splice":c=!0,s=s.map((t,n)=>n>1?e(t):t)}return o=r.apply(t,s),c&&this.trigger("change",{method:n}),o}:r}},r=new Proxy(t.map(e),n);i.set(this,r)}get Model(){return c}get models(){return i.get(this)}}const a=new WeakMap;class p{constructor(t){const e={context:t,register:{}};a.set(this,e)}add(t,e){const{register:n}=a.get(this);return n[t]=e,this}remove(t){const{register:e}=a.get(this);return e[t]=void 0,delete e[t],this}get(t){const{register:e}=a.get(this);return e[t]}has(t){return!!this.get(t)}}class h extends p{constructor(t){super(t);const e=a.get(this),{register:n}=e;e.onAction=(e=>{const{type:r}=e,s=n[r];s&&s.forEach(n=>{var r=new n;r.context=t,r.event=e,r.run()})})}add(t,e){const n=a.get(this),{context:r,onAction:s}=n,o=this.get(t);return o||r.on(t,s),e=(o||[]).concat(e),super.add(t,e)}remove(t,e){const n=this.get(t);return n&&n.length&&(e instanceof Array||(e=[e]),e.forEach(t=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)}),0===n.length)?super.remove(t):this}}class l extends s{constructor(){super(),a.set(this,{actions:new h(this),values:new p(this)})}get actions(){return a.get(this).actions}get values(){return a.get(this).values}}n.d(e,"Collection",function(){return u}),n.d(e,"Context",function(){return l}),n.d(e,"EventEmitter",function(){return s}),n.d(e,"Model",function(){return c})}])});